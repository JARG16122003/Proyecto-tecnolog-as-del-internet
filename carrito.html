<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Carrito de compras</title>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined" /> 
    <link href="https://fonts.googleapis.com/css2?family=Pacifico&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="./css/carrito.css">
</head>
<body>
    <header>
        <div class="logo">
            <img class = "logo" src="img/logoTerolaCakes.png" alt="logo terolacakes">
        </div>

        <input type = "checkbox" class=  "menu-toggle" id = "menu-toggle">
        <label for = "menu-toggle" class = "menu-icon">
            <span></span>
            <span></span>
            <span></span>
        </label>
        
        <nav>
                <a href="index.html">Inicio</a>
                <a href="products.html">Productos</a>
                <a href="nosotros.html">Nosotros</a>
                <a href="pedido.html">Pedidos especiales</a>
                <a href="brunch.html">Brunch</a>
        </nav>

        <div class = "icons">
            <a href="carrito.html"><span class="material-symbols-outlined">shopping_cart</span></a>
            <a href="login.html"><span class="material-symbols-outlined">account_circle</span></a>
        </div>
    </header>

    <main>
        <div id="carrito-container"></div>
        <div id="total-container">
            <p>Total: $<span id="total">0</span></p>
            <button id="vaciar-btn">Vaciar carrito</button>
            <button id="comprar-btn">Comprar</button>
        </div>
    </main>

    <script src="../frontjs/carrito.js"></script>
    <script>
        const token = "TU_TOKEN_DE_LOGIN_AQUI"; // reemplaza con token real
        const carritoContainer = document.getElementById("carrito-container");
        const totalSpan = document.getElementById("total");
        const vaciarBtn = document.getElementById("vaciar-btn");
        const comprarBtn = document.getElementById("comprar-btn");

        async function renderCarrito() {
            const productos = await obtenerCarrito(token);
            carritoContainer.innerHTML = "";
            let total = 0;

            productos.forEach(p => {
                const div = document.createElement("div");
                div.className = "producto-carrito";
                div.innerHTML = `
                    <p>${p.nombre} x${p.cantidad}</p>
                    <p>$${p.precio * p.cantidad}</p>
                `;
                carritoContainer.appendChild(div);
                total += p.precio * p.cantidad;
            });

            totalSpan.textContent = total;
        }

        vaciarBtn.addEventListener("click", async () => {
            await fetch("/api/carrito", {
                method: "DELETE",
                headers: { "Authorization": `Bearer ${token}` }
            });
            renderCarrito();
        });

        comprarBtn.addEventListener("click",() => {
            window.location.href = "compra.html";
        });

        renderCarrito();
    </script>
</body>
</html><script src="frontjs/carrito.js"></script>
